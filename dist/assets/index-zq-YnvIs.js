import{r as l,j as e,B as W,S as ge,a as be,b as Ge,M as Je,U as le,c as Ve,L as Re,C as He,d as We,e as Ke,f as Be,T as Le,g as Qe,h as ye,i as Xe,k as Ye,D as Ze,l as es,m as ss,n as as,P as ts,X as rs,o as os,p as ns,R as is,q as ls}from"./vendor-react-C6dvtoDU.js";import{d as P,s as M,T as q,g as ie,u as re,c as z,a as O,b as cs,i as ds,e as us,f as je,h as ms,j as xs,k as fs,o as Fe,l as he,m as pe,n as oe,q as Q,w as $e,r as ve,p as hs,t as ps,v as gs,x as we,y as ae,z as bs,A as Ne,B as Se,C as ys,D as js}from"./vendor-firebase-qVgbNTqe.js";import"./vendor-DhMbaX6P.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();class vs{async saveUserProfile(s,r){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const t=P(f,L.USERS,s);await M(t,{...r,profileComplete:!0,updatedAt:q.now()},{merge:!0})}catch(t){throw console.error("Error guardando el perfil del usuario:",t),t}}async getUserProfile(s){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getUserProfile"),null;const r=P(f,L.USERS,s),t=await ie(r);return t.exists()?{uid:t.id,...t.data()}:(console.log(`No profile found for user ${s}`),null)}catch(r){throw console.error("Error obteniendo el perfil del usuario:",r),r}}async createUser(s,r,t){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const o=P(f,L.USERS,s),i=t.name?.split(" ")||[],u=i[0]||"",x=i.slice(1).join(" ");await M(o,{email:r,role:"user",profileComplete:!1,createdAt:q.now(),updatedAt:q.now(),firstName:u,lastName:x,...t})}catch(o){throw console.error("Error creando el perfil del usuario:",o),o}}async updateUserRole(s,r){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const t=P(f,L.USERS,s);await re(t,{role:r}),console.log(`Rol del usuario ${s} actualizado a ${r}`)}catch(t){throw console.error(`Error actualizando el rol para el usuario ${s}:`,t),t}}async getUserPreferences(s){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getUserPreferences"),null;const r=P(f,L.USERS,s),t=await ie(r);return t.exists()?{...t.data().jobPreferences}:null}catch(r){return console.error("Error obteniendo preferencias:",r),null}}async getAllUsers(){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getAllUsers"),[];const s=z(f,L.USERS);return(await O(s)).docs.map(t=>({id:t.id,...t.data()}))}catch(s){return console.error("Error obteniendo todos los usuarios:",s),[]}}async deleteUserAdmin(s){throw console.warn(`La eliminaciÃ³n del usuario ${s} debe ser manejada por una Cloud Function.`),new Error("La eliminaciÃ³n de usuarios no estÃ¡ implementada directamente en el cliente por seguridad y complejidad.")}}const U=new vs,ws={apiKey:"AIzaSyBTFeZb2YghE21teJcC475Tm9a0ybfF2Xg",authDomain:"chapatuchamba-cdd3a.firebaseapp.com",projectId:"chapatuchamba-cdd3a",storageBucket:"chapatuchamba-cdd3a.appspot.com",messagingSenderId:"640735978088",appId:"1:640735978088:web:ae416ed336a03e41a5d1dd"},Y=cs().length?us():ds(ws),ne=je(Y),f=ms(Y),te=xs(Y);fs(Y,"us-central1");const ce=()=>{const[a,s]=l.useState(null),[r,t]=l.useState(!0);return l.useEffect(()=>{const i=Fe(ne,async u=>{if(u){const x=await U.getUserProfile(u.uid);x?(console.log(`[AUTH] SesiÃ³n hidratada para ${x.email}, rol: ${x.role}`),s({uid:u.uid,email:u.email||"",name:x.name,role:x.role||"user"})):(console.error(`[AUTH] Error: Usuario autenticado con UID ${u.uid} pero sin perfil en Firestore. Cerrando sesiÃ³n.`),he(ne),s(null))}else console.log("[AUTH] No se detectÃ³ ningÃºn usuario."),s(null);t(!1)});return()=>i()},[]),{currentUserSession:a,authLoading:r,userLogout:()=>he(ne)}},L={JOBS:"jobs",USERS:"users"},Ee=a=>a,X=(a,s)=>`users/${a}/${s}`,Ae=[{title:"Desarrollador Full Stack (Remoto)",companyName:"GlobalTech Solutions",company:"GlobalTech Solutions",location:"Remoto - LatinoamÃ©rica",salaryMin:8e4,salaryMax:12e4,contractType:"Full-time",description:"Buscamos un ingeniero Full Stack apasionado con experiencia en TypeScript, React y Node.js para unirse a nuestro equipo global.",postedBy:"rec_gt",postedAt:new Date(Date.now()-864e5).toISOString(),keywords:["react","node","typescript","fullstack"],tags:["React","TypeScript","Node.js","AWS","MongoDB"],source:"Publicado"},{title:"Analista de Datos Senior",companyName:"Data Insights",company:"Data Insights",location:"BogotÃ¡, Colombia",salaryMin:6e4,salaryMax:9e4,contractType:"Contract",description:"AnÃ¡lisis de grandes volÃºmenes de datos usando Python y SQL. Se requiere experiencia previa en sector financiero.",postedBy:"rec_di",postedAt:new Date(Date.now()-3456e5).toISOString(),keywords:["python","sql","datos","senior"],tags:["Python","SQL","Tableau","Pandas"],source:"Publicado"},{title:"DiseÃ±ador UX/UI Junior",companyName:"Creative Design Studio",company:"Creative Design Studio",location:"Ciudad de MÃ©xico, MÃ©xico",salaryMin:35e3,salaryMax:5e4,contractType:"Full-time",description:"DiseÃ±o de interfaces centrado en el usuario utilizando Figma y principios de accesibilidad.",postedBy:"rec_cds",postedAt:new Date(Date.now()-1728e5).toISOString(),keywords:["ux","ui","figma","diseÃ±o","junior"],tags:["Figma","Sketch","Prototipado","UX Research"],source:"Publicado"},{title:"Pasante de Ciberseguridad",companyName:"Security First",company:"Security First",location:"Remoto - Global",salaryMin:18e3,salaryMax:24e3,contractType:"Internship",description:"Asistencia en el monitoreo de redes y anÃ¡lisis de vulnerabilidades. Excelente oportunidad para aprender.",postedBy:"rec_sf",postedAt:new Date(Date.now()-6048e5).toISOString(),keywords:["ciberseguridad","pasante","seguridad"],tags:["Networking","Pen Testing","Linux"],source:"Publicado"}],Ns=l.createContext(void 0),Ss=({children:a,currentUserSession:s})=>{const[r,t]=l.useState([]),[o,i]=l.useState([]),[u,x]=l.useState({keywords:[],minSalary:0,locations:[],jobTypes:[],emailFrequency:"weekly",sectorGeneral:"TecnologÃ­a",experience:"Sin experiencia",modality:"Remoto"}),[n,p]=l.useState(null),[m,b]=l.useState(!0),[E,d]=l.useState(!0),[h,j]=l.useState({keyword:"",location:""}),C=async c=>{if(f)try{for(const g of Ae)try{await we(c,{...g,postedAt:new Date().toISOString()})}catch(N){console.error("Error adding seed job",N)}console.log("Database seeded successfully with initial job data.")}catch(g){console.error("Error seeding database:",g)}},D=c=>`ctc_local_user_${c}`,k=c=>{try{const g=typeof window<"u"?localStorage.getItem(D(c)):null;return g?JSON.parse(g):null}catch(g){return console.error("Error reading local data",g),null}},F=(c,g)=>{try{typeof window<"u"&&localStorage.setItem(D(c),JSON.stringify(g))}catch(N){console.error("Error writing local data",N)}},I=async c=>{if(!f){b(!0),j(c);try{const S=Ae.map((v,B)=>({id:`seed-${B}`,...v})).filter(v=>(!c.keyword||v.title.toLowerCase().includes(c.keyword.toLowerCase())||v.companyName.toLowerCase().includes(c.keyword.toLowerCase())||v.description.toLowerCase().includes(c.keyword.toLowerCase()))&&(!c.location||v.location.toLowerCase().includes(c.location.toLowerCase())));t(S)}catch(w){console.error("Error loading seed jobs locally:",w)}finally{b(!1)}return}b(!0),j(c);const g=Ee("jobs"),N=z(f,g),A=[oe("postedAt","desc")];try{const w=Q(N,...A),S=await O(w),B=S.docs.map(R=>({id:R.id,...R.data()})).filter(R=>(!c.keyword||R.title.toLowerCase().includes(c.keyword.toLowerCase())||R.companyName.toLowerCase().includes(c.keyword.toLowerCase())||R.description.toLowerCase().includes(c.keyword.toLowerCase()))&&(!c.location||R.location.toLowerCase().includes(c.location.toLowerCase())));if(t(B),S.empty){await C(N);const Oe=(await O(w)).docs.map(V=>({id:V.id,...V.data()})).filter(V=>(!c.keyword||V.title.toLowerCase().includes(c.keyword.toLowerCase())||V.companyName.toLowerCase().includes(c.keyword.toLowerCase())||V.description.toLowerCase().includes(c.keyword.toLowerCase()))&&(!c.location||V.location.toLowerCase().includes(c.location.toLowerCase())));t(Oe)}}catch(w){console.error("Error fetching jobs:",w)}finally{b(!1)}};l.useEffect(()=>{if(!s){i([]),p(null),x(v=>({...v,minSalary:0})),d(!1);return}const c=s.uid;if(!f){const v=k(c)||{};i(v.savedJobs||[]),p(v.profile||{uid:c,name:s.email.split("@")[0]||"Nuevo Candidato",headline:"Busco mi primera oportunidad profesional.",skills:["ComunicaciÃ³n","Trabajo en equipo"],education:[],cvUrl:null}),x(v.preferences||{keywords:[],minSalary:0,locations:["Remoto"],jobTypes:["Full-time"],emailFrequency:"weekly",sectorGeneral:"TecnologÃ­a",experience:"Junior",modality:"HÃ­brido"}),d(!1);return}const g=X(c,"userData"),N=P(f,g,"preferences"),A=P(f,g,"profile"),w=pe(N,v=>{if(v.exists()){const B=v.data();B.savedJobs&&i(B.savedJobs),B.preferences&&x(R=>({...R,...B.preferences}))}else M(N,{savedJobs:[],preferences:{keywords:[],minSalary:0,locations:["Remoto"],jobTypes:["Full-time"],emailFrequency:"weekly",sectorGeneral:"TecnologÃ­a",experience:"Junior",modality:"HÃ­brido"}},{merge:!0}).catch(R=>console.error("Error creating default user prefs:",R))},v=>{console.error("Error listening to user preferences:",v)}),S=pe(A,v=>{if(v.exists())p(v.data());else{const B={uid:c,name:s.email.split("@")[0]||"Nuevo Candidato",headline:"Busco mi primera oportunidad profesional.",skills:["ComunicaciÃ³n","Trabajo en equipo"],education:[],cvUrl:null};M(A,B,{merge:!0}).catch(R=>console.error("Error creating default student profile:",R)),p(B)}d(!1)},v=>{console.error("Error listening to student profile:",v),d(!1)});return()=>{w(),S()}},[s]),l.useEffect(()=>{I(h)},[s?.uid]);const Z=c=>{I(c)},ue=async c=>{if(!s)return;const g=s.uid,N=o.includes(c)?o.filter(w=>w!==c):[...o,c];if(i(N),!f){const w=k(g)||{};w.savedJobs=N,F(g,w);return}const A=P(f,X(g,"userData"),"preferences");try{await M(A,{savedJobs:N},{merge:!0})}catch(w){console.error("Error saving job:",w)}},ee=async c=>{if(!s)return;const g=s.uid,N={...u,...c};if(x(N),!f){const w=k(g)||{};w.preferences=N,F(g,w);return}const A=P(f,X(g,"userData"),"preferences");try{await M(A,{preferences:N},{merge:!0})}catch(w){console.error("Error updating preferences:",w)}},y=async c=>{if(!s||s.role!=="recruiter"&&s.role!=="admin")return;if(!f){const A={id:`local-${Date.now()}`,...c,postedAt:new Date().toISOString()};t(w=>[A,...w]);return}const g=Ee("jobs"),N=z(f,g);try{await we(N,{...c,postedBy:s.uid,postedAt:new Date().toISOString()}),console.log(`Nueva oferta publicada por ${s.uid}`)}catch(A){console.error("Error adding new job:",A)}},$=async c=>{if(!s)return console.error("User not logged in."),null;const g=s.uid;if(!te){const A=`https://local.fake.storage/${g}/cv_${Date.now()}.pdf`;return await G({cvUrl:A}),A}const N=ve(te,`cvs/${g}/cv_${Date.now()}.pdf`);try{const A=await ps(N,c),w=await gs(A.ref);return await G({cvUrl:w}),w}catch(A){return console.error("Error uploading CV:",A),null}},se=async()=>{if(!(!s||!n||!n.cvUrl)){if(!te){await G({cvUrl:null});return}try{const c=ve(te,n.cvUrl);await hs(c),await G({cvUrl:null}),console.log("CV deleted successfully.")}catch(c){console.error("Error deleting CV:",c)}}},G=async c=>{if(!s)return;const g=s.uid,N=n?{...n,...c}:{uid:g,...c};if(p(N),!f){const S=k(g)||{};S.profile=N,F(g,S);return}const A=X(g,"userData"),w=P(f,A,"profile");try{await M(w,c,{merge:!0}),p(S=>S?{...S,...c}:null)}catch(S){console.error("Error updating student profile:",S)}},me=async()=>{if(!s)return;const c=s.uid;try{if(n?.cvUrl&&await se(),!f){try{typeof window<"u"&&localStorage.removeItem(D(c))}catch(A){console.warn("Could not remove localStorage key for user",c,A)}p(null),i([]),x(A=>({...A,minSalary:0}));return}const g=$e(f),N=X(c,"userData");g.delete(P(f,N,"preferences")),g.delete(P(f,N,"profile")),await g.commit(),await he(ne)}catch(g){console.error("Error deleting user account:",g)}},Ue=()=>{if(r.length===0)return{totalJobs:0,avgSalary:0,topSkills:[],jobsBySource:[],generatedAt:new Date().toISOString()};const c=r.filter(S=>S.salaryMin>0&&S.salaryMax>0),g=c.length?Math.round(c.reduce((S,v)=>S+(v.salaryMin+v.salaryMax)/2,0)/c.length):0,N={};r.forEach(S=>S.tags?.forEach(v=>N[v]=(N[v]||0)+1));const A=Object.entries(N).sort(([,S],[,v])=>v-S).slice(0,5).map(([S,v])=>({name:S,count:v})),w={};return r.forEach(S=>w[S.source||"Publicado"]=(w[S.source||"Publicado"]||0)+1),{totalJobs:r.length,avgSalary:g,topSkills:A,jobsBySource:Object.entries(w).map(([S,v])=>({source:S,count:v})),generatedAt:new Date().toISOString()}},Me=async()=>s?new Promise(c=>setTimeout(()=>{c(!0)},2e3)):!1,qe={jobs:r,savedJobs:o,preferences:u,studentProfile:n,user:s,userRole:s?.role||null,isLoading:m||E,isJobsLoading:m,toggleSaveJob:ue,updatePreferences:ee,addNewJob:y,updateStudentProfile:G,uploadCV:$,deleteCV:se,deleteUserAccount:me,currentFilters:h,setSearchFilters:Z,fetchJobs:I,generateReport:Ue,sendEmailReport:Me};return e.jsx(Ns.Provider,{value:qe,children:a})},H=({screen:a,icon:s,label:r,currentScreen:t,setCurrentScreen:o,onItemClick:i})=>e.jsxs("button",{onClick:()=>{o(a),i?.()},className:`flex items-center w-full px-4 py-3 rounded-xl mb-2 transition-all duration-200 group ${t===a?"bg-blue-100 text-blue-700 font-bold shadow-sm":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(s,{size:20,className:`mr-3 ${t===a?"stroke-[2.5px]":""}`}),r]}),Ce=({userRole:a,currentScreen:s,setCurrentScreen:r,handleLogout:t,onItemClick:o})=>e.jsxs("aside",{className:"hidden md:flex flex-col w-64 bg-white border-r border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx(W,{className:"text-blue-600",size:32}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 ml-2",children:"ChapaTuChamba"})]}),e.jsxs("nav",{className:"flex-1",children:[a==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{screen:"user_home",icon:ge,label:"Buscar Empleos",currentScreen:s,setCurrentScreen:r,onItemClick:o}),e.jsx(H,{screen:"saved",icon:be,label:"Guardados",currentScreen:s,setCurrentScreen:r,onItemClick:o}),e.jsx(H,{screen:"notifications",icon:Ge,label:"Notificaciones",currentScreen:s,setCurrentScreen:r,onItemClick:o})]}),a==="admin"&&e.jsx(H,{screen:"admin_dash",icon:Je,label:"Admin Dashboard",currentScreen:s,setCurrentScreen:r,onItemClick:o}),a==="recruiter"&&e.jsx(H,{screen:"recruiter_dash",icon:W,label:"Recruiter Dashboard",currentScreen:s,setCurrentScreen:r,onItemClick:o})]}),e.jsxs("div",{className:"mt-auto",children:[e.jsx(H,{screen:"profile",icon:le,label:"Mi Perfil",currentScreen:s,setCurrentScreen:r,onItemClick:o}),e.jsx(H,{screen:"preferences",icon:Ve,label:"Preferencias",currentScreen:s,setCurrentScreen:r,onItemClick:o}),e.jsxs("button",{onClick:t,className:"flex items-center w-full px-4 py-3 text-gray-600 hover:bg-gray-100 rounded-lg",children:[e.jsx(Re,{size:20,className:"mr-3"}),"Cerrar SesiÃ³n"]})]})]}),K=({screen:a,icon:s,label:r,currentScreen:t,setCurrentScreen:o})=>e.jsxs("button",{onClick:()=>o(a),className:`flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors ${t===a?"text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:[e.jsx(s,{size:24,strokeWidth:t===a?2.5:2}),e.jsx("span",{className:"text-[10px] font-medium",children:r})]}),Es=({userRole:a,currentScreen:s,setCurrentScreen:r})=>e.jsxs("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t h-16 flex justify-around items-center shadow-inner",children:[a==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{screen:"user_home",icon:ge,label:"Buscar",currentScreen:s,setCurrentScreen:r}),e.jsx(K,{screen:"saved",icon:be,label:"Guardados",currentScreen:s,setCurrentScreen:r}),e.jsx(K,{screen:"reports",icon:He,label:"Reportes",currentScreen:s,setCurrentScreen:r}),e.jsx(K,{screen:"profile",icon:le,label:"Perfil",currentScreen:s,setCurrentScreen:r})]}),a==="admin"&&e.jsx(K,{screen:"admin_dash",icon:Je,label:"Admin",currentScreen:s,setCurrentScreen:r}),a==="recruiter"&&e.jsx(K,{screen:"recruiter_dash",icon:W,label:"Portal",currentScreen:s,setCurrentScreen:r})]}),As=({onMenuToggle:a})=>e.jsxs("header",{className:"md:hidden flex items-center justify-between p-4 bg-white border-b",children:[e.jsx("h1",{className:"text-xl font-bold text-blue-600",children:"ChapaTuChamba"}),e.jsx("button",{onClick:a,children:e.jsx(We,{size:24})})]}),de=()=>e.jsx("div",{className:"flex h-screen w-screen items-center justify-center bg-gray-100",children:e.jsx(Ke,{className:"animate-spin text-blue-600",size:48})});class Cs{async saveJob(s,r,t){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const o=P(z(f,`users/${r}/saved_jobs`));return await M(o,{jobId:s.id,userId:r,savedAt:q.now(),notes:t||""}),o.id}catch(o){throw console.error("Error guardando oferta:",o),o}}async getSavedJobs(s){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getSavedJobs"),[];const r=Q(z(f,`users/${s}/saved_jobs`),oe("savedAt","desc")),o=(await O(r)).docs.map(m=>{const b=m.data();return{id:m.id,jobId:b.jobId,userId:b.userId,notes:b.notes,savedAt:b.savedAt}});if(o.length===0)return[];const i=o.map(m=>m.jobId),u=Q(z(f,L.JOBS),ae(bs(),"in",i)),x=await O(u),n=new Map(x.docs.map(m=>{const b=m.data(),E=b.postedAt instanceof q?b.postedAt.toDate():b.postedAt,d={...b,id:m.id,postedAt:E};return[m.id,d]}));return o.map(m=>{const b=n.get(m.jobId);return b?{id:m.id,jobId:m.jobId,userId:m.userId,notes:m.notes,savedAt:m.savedAt.toDate(),job:b}:null}).filter(m=>m!==null)}catch(r){return console.error("Error obteniendo ofertas guardadas:",r),[]}}async getSavedJob(s,r){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getSavedJob"),null;const t=P(f,`users/${r}/saved_jobs`,s),o=await ie(t);if(!o.exists())return null;const i=o.data(),u=P(f,L.JOBS,i.jobId),x=await ie(u);if(x.exists()){const n=x.data(),p=n.postedAt instanceof q?n.postedAt.toDate():n.postedAt,m={...n,id:x.id,postedAt:p};return{id:o.id,jobId:i.jobId,userId:i.userId,notes:i.notes,savedAt:i.savedAt.toDate(),job:m}}return null}catch(t){return console.error("Error obteniendo oferta:",t),null}}listenToUserNotifications(s,r){if(!f)return console.warn("[FIREBASE] DB not initialized - listenToUserNotifications"),()=>{};const t=Q(z(f,`users/${s}/notifications`),oe("createdAt","desc"),Ne(20));return pe(t,i=>{const u=i.docs.map(x=>{const n=x.data();return{id:x.id,...n,createdAt:n.createdAt.toDate()}});r(u)},i=>{console.error("Error en el listener de notificaciones:",i)})}async markNotificationAsRead(s,r){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const t=P(f,`users/${s}/notifications`,r);await re(t,{read:!0})}catch(t){throw console.error("Error marcando notificaciÃ³n como leÃ­da:",t),t}}async markAllNotificationsAsRead(s){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const r=Q(z(f,`users/${s}/notifications`),ae("read","==",!1)),t=await O(r);if(t.empty)return;const o=$e(f);t.docs.forEach(i=>{o.update(i.ref,{read:!0})}),await o.commit()}catch(r){throw console.error("Error marcando todas las notificaciones como leÃ­das:",r),r}}async removeSavedJob(s,r){try{if(!f)throw new Error("[FIREBASE] DB not initialized");await Se(P(f,`users/${r}/saved_jobs`,s))}catch(t){throw console.error("Error eliminando oferta guardada:",t),t}}async updateJobNotes(s,r,t){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const o=P(f,`users/${r}/saved_jobs`,s);await re(o,{notes:t})}catch(o){throw console.error("Error actualizando notas:",o),o}}async searchJobs(s={},r=20){try{if(!f)return[];const t=[],o=`${s.keyword||""} ${s.location||""}`.toLowerCase().trim().split(/\s+/).filter(n=>n.length>0);o.length>0&&o.slice(0,10).forEach(n=>{t.push(ae("_searchKeywords","array-contains",n))}),s.minSalary&&t.push(ae("salary.min",">=",s.minSalary)),t.push(oe("postedAt","desc"),Ne(r));const i=Q(z(f,L.JOBS),...t);return(await O(i)).docs.map(n=>{const p=n.data(),m=p.postedAt instanceof q?p.postedAt.toDate():p.postedAt;return{id:n.id,...p,postedAt:m}})}catch(t){return console.error("Error buscando ofertas:",t),[]}}async getAllJobsAdmin(){try{if(!f)return console.warn("[FIREBASE] DB not initialized - getAllJobsAdmin"),[];const s=z(f,L.JOBS);return(await O(s)).docs.map(t=>{const o=t.data(),i=o.postedAt instanceof q?o.postedAt.toDate():o.postedAt;return{id:t.id,...o,postedAt:i}})}catch(s){return console.error("Error obteniendo todas las ofertas de trabajo (Admin):",s),[]}}async updateJobStatus(s,r){try{if(!f)throw new Error("[FIREBASE] DB not initialized");const t=P(f,L.JOBS,s);await re(t,{status:r}),console.log(`Estado del trabajo ${s} actualizado a ${r}`)}catch(t){throw console.error(`Error actualizando el estado del trabajo ${s}:`,t),t}}async deleteJobAdmin(s){try{if(!f)throw new Error("[FIREBASE] DB not initialized");await Se(P(f,L.JOBS,s)),console.log(`Trabajo ${s} eliminado de la colecciÃ³n principal.`)}catch(r){throw console.error(`Error eliminando el trabajo ${s}:`,r),r}}}const _=new Cs,T=({variant:a="primary",icon:s,children:r,isLoading:t=!1,className:o,disabled:i,fullWidth:u=!1,...x})=>{let n="inline-flex items-center justify-center font-bold px-4 py-2 rounded-xl transition-all duration-200 shadow-md disabled:opacity-50 disabled:cursor-not-allowed";switch(a){case"secondary":n+=" bg-white text-gray-700 border border-gray-300 hover:bg-gray-100 shadow-none";break;case"danger":n+=" bg-red-600 text-white hover:bg-red-700 shadow-red-600/30";break;case"outline":n+=" bg-white text-gray-700 border border-gray-300 hover:bg-gray-100 shadow-none";break;case"ghost":n+=" bg-transparent text-gray-600 hover:bg-gray-100 shadow-none";break;case"primary":default:n+=" bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/30";break}const p=u?"w-full":"";return e.jsx("button",{className:`${n} ${p} ${o||""}`,disabled:i||t,...x,children:t?e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsxs(e.Fragment,{children:[s&&e.jsx("span",{className:`mr-2 ${r?"":"m-0"}`,children:s}),r]})})},Ps=({user:a,onUserDeleted:s})=>{const[r,t]=l.useState(!1),[o,i]=l.useState(!1),u=async()=>{if(window.confirm(`Are you sure you want to delete user ${a.email||a.id}? This action cannot be undone.`)){i(!0);try{await U.deleteUserAdmin(a.id),s(a.id)}catch(x){alert(x.message)}finally{i(!1)}}};return e.jsxs("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>t(!r),className:"w-full text-left p-4 flex justify-between items-center hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full mr-4",children:e.jsx(le,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:a.email||"No email provided"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",e.jsx("span",{className:"font-medium text-gray-700",children:a.role||"N/A"})]})]})]}),e.jsx(Be,{className:`h-5 w-5 text-gray-400 transform transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:"Detalles del Usuario"}),e.jsxs("div",{className:"text-sm space-y-2 text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User ID:"})," ",a.id]}),a.preferences&&e.jsxs("div",{children:[e.jsx("strong",{children:"Preferencias:"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded text-xs whitespace-pre-wrap font-mono",children:JSON.stringify(a.preferences,null,2)})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end",children:e.jsxs(T,{onClick:u,isLoading:o,className:"bg-red-600 hover:bg-red-700",children:[e.jsx(Le,{size:16,className:"mr-2"}),"Eliminar Usuario"]})})]})]})},ks=({job:a,onJobUpdate:s,onJobDeleted:r})=>{const[t,o]=l.useState(!1),[i,u]=l.useState(!1),x=async()=>{const m=a.status==="active"?"inactive":"active";u(!0);try{await _.updateJobStatus(a.id,m),s({...a,status:m})}catch(b){alert("Failed to update job status."),console.error(b)}finally{u(!1)}},n=async()=>{if(window.confirm(`Are you sure you want to delete the job "${a.title}"? This action is permanent.`)){u(!0);try{await _.deleteJobAdmin(a.id),r(a.id)}catch(m){alert("Failed to delete job."),console.error(m)}finally{u(!1)}}},p={active:"bg-green-100 text-green-800",inactive:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800"};return e.jsxs("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>o(!t),className:"w-full text-left p-4 flex justify-between items-center hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full mr-4",children:e.jsx(W,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-800 truncate",children:a.title}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-1",children:[e.jsx(Qe,{size:14,className:"mr-1.5"}),e.jsx("span",{children:a.company}),e.jsx("span",{className:"mx-2",children:"Â·"}),e.jsx(ye,{size:14,className:"mr-1.5"}),e.jsx("span",{children:a.location})]})]})]}),e.jsxs("div",{className:"flex items-center ml-4",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p[a.status]||"bg-gray-100 text-gray-800"}`,children:a.status}),e.jsx(Be,{className:`h-5 w-5 text-gray-400 ml-4 transform transition-transform ${t?"rotate-180":""}`})]})]}),t&&e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-700",children:"Detalles de la Oferta"}),e.jsxs("div",{className:"text-sm space-y-3 text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",a.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fuente:"})," ",a.source]}),e.jsx("p",{children:e.jsx("strong",{children:"DescripciÃ³n:"})}),e.jsx("p",{className:"pl-2 border-l-2 border-gray-300 line-clamp-4",children:a.description}),a.skills&&a.skills.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Skills:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.skills.map(m=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full",children:m},m))})]}),e.jsx("a",{href:a.jobUrl,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:underline",children:"Ver oferta original â†’"})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsxs(T,{onClick:x,isLoading:i,className:"bg-gray-200 text-gray-800 hover:bg-gray-300",children:[a.status==="active"?e.jsx(Xe,{size:16,className:"mr-2"}):e.jsx(Ye,{size:16,className:"mr-2"}),a.status==="active"?"Desactivar":"Activar"]}),e.jsxs(T,{onClick:n,isLoading:i,className:"bg-red-600 hover:bg-red-700",children:[e.jsx(Le,{size:16,className:"mr-2"}),"Eliminar Oferta"]})]})]})]})},Ds=()=>{const[a,s]=l.useState("users"),[r,t]=l.useState([]),[o,i]=l.useState([]),[u,x]=l.useState(!0),[n,p]=l.useState(null);l.useEffect(()=>{(async()=>{x(!0),p(null);try{if(a==="users"){const j=await U.getAllUsers();t(j)}else{const j=await _.getAllJobsAdmin();i(j)}}catch(j){p("Failed to fetch data. Please try again later."),console.error(j)}finally{x(!1)}})()},[a]);const m=h=>{t(j=>j.filter(C=>C.id!==h))},b=h=>{i(j=>j.map(C=>C.id===h.id?h:C))},E=h=>{i(j=>j.filter(C=>C.id!==h))},d=()=>{if(u)return e.jsx(de,{});if(n)return e.jsx("div",{className:"text-red-500 text-center",children:n});if(a==="users")return e.jsx("div",{className:"space-y-4",children:r.length>0?r.map(h=>e.jsx(Ps,{user:h,onUserDeleted:m},h.id)):e.jsx("p",{className:"text-gray-500",children:"No users found."})});if(a==="jobs")return e.jsx("div",{className:"space-y-4",children:o.length>0?o.map(h=>e.jsx(ks,{job:h,onJobUpdate:b,onJobDeleted:E},h.id)):e.jsx("p",{className:"text-gray-500",children:"No jobs found."})})};return e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Panel de AdministraciÃ³n"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona usuarios, ofertas de trabajo y fuentes."})]}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>s("users"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center ${a==="users"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(le,{className:"mr-2 h-5 w-5"}),"Gestionar Usuarios (",r.length,")"]}),e.jsxs("button",{onClick:()=>s("jobs"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center ${a==="jobs"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(W,{className:"mr-2 h-5 w-5"}),"Gestionar Trabajos (",o.length,")"]})]})}),e.jsx("main",{children:d()})]})},J=({label:a,icon:s,className:r,id:t,...o})=>{const i=t||(a?a.toLowerCase().replace(/\s/g,"-"):void 0);return e.jsxs("div",{className:"space-y-1.5",children:[a&&e.jsx("label",{htmlFor:i,className:"block text-sm font-medium text-gray-700",children:a}),e.jsxs("div",{className:"flex items-center",children:[s&&e.jsx("div",{className:"absolute left-3 text-gray-400 pointer-events-none",children:e.jsx(s,{size:20})}),e.jsx("input",{id:i,className:`w-full p-3 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 focus:ring-2 focus:ring-blue-600/20 focus:border-blue-600 outline-none transition-all ${s?"pl-10":"pl-4"} ${r||""}`,...o})]})]})},Is=a=>{if(!a||a.min===void 0&&a.max===void 0)return"Salario no especificado";const s=i=>`${Math.round(i/1e3)}k`,r=a.min?s(a.min):null,t=a.max?s(a.max):null;let o="";return r&&t&&r!==t?o=`${r} - ${t}`:o=r||t||"",o?a.currency?`${o} ${a.currency}`:`$${o}`:"Salario no especificado"},Js=a=>{if(!a)return null;const s=Math.floor((Date.now()-new Date(a).getTime())/(1e3*60*60*24));return s<0?"PrÃ³ximamente":s===0?"Hoy":`Hace ${s} dÃ­a${s!==1?"s":""}`},Te=({job:a,isSaved:s,onSaveToggle:r,isSelected:t,onSelectToggle:o,showSelection:i=!1})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-base line-clamp-2",children:a.title}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:a.company})]}),e.jsx("button",{onClick:r,"aria-label":s?"Quitar de guardados":"Guardar oferta",className:`flex-shrink-0 p-2 rounded-lg transition-colors ${s?"bg-red-100 text-red-600 hover:bg-red-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s?"Quitar de guardados":"Guardar oferta",children:e.jsx(be,{size:18,fill:s?"currentColor":"none"})})]})}),e.jsxs("div",{className:"p-5 space-y-4 flex-grow",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[e.jsx(ye,{size:16,className:"mr-2 text-blue-600"}),a.location]}),a.salary&&e.jsxs("div",{className:"flex items-center text-gray-600 text-sm font-medium",children:[e.jsx(Ze,{size:16,className:"mr-2 text-green-600"}),Is(a.salary)]}),a.postedAt&&e.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[e.jsx(es,{size:16,className:"mr-2"}),Js(a.postedAt)]})]}),a.description&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-3",children:a.description}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[a.skills.slice(0,3).map(u=>e.jsx("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded",children:u},u)),a.skills.length>3&&e.jsxs("span",{className:"inline-block text-gray-500 text-xs px-2 py-1",children:["+",a.skills.length-3]})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-200 flex items-center gap-2",children:[i&&o&&e.jsx("input",{type:"checkbox",checked:t,onChange:o,className:"w-4 h-4 rounded border-gray-300 text-blue-600 cursor-pointer"}),e.jsx(T,{onClick:()=>window.open(a.jobUrl,"_blank"),className:"flex-1 text-center",fullWidth:!0,children:"Ver Oferta â†’"})]})]}),Rs=()=>{const[a,s]=l.useState(""),[r,t]=l.useState(""),[o,i]=l.useState([]),[u,x]=l.useState(!1),[n,p]=l.useState(new Map),{currentUserSession:m}=ce();l.useEffect(()=>{if(!m?.uid){i([]),p(new Map);return}(async()=>{try{const h=await _.getSavedJobs(m.uid),j=new Map(h.map(C=>[C.jobId,C.id]));p(j),await b()}catch(h){console.error("Error cargando ofertas guardadas:",h)}})()},[m?.uid]);const b=async d=>{d&&d.preventDefault(),x(!0);try{const h=await _.searchJobs({keyword:a,location:r});i(h)}catch(h){console.error("Error en bÃºsqueda:",h)}finally{x(!1)}},E=async d=>{if(!m?.uid){alert("Por favor, inicia sesiÃ³n para guardar ofertas.");return}const h=n.has(d.id);try{if(h){const j=n.get(d.id);p(C=>{const D=new Map(C);return D.delete(d.id),D}),await _.removeSavedJob(j,m.uid)}else{const j=await _.saveJob(d,m.uid);p(C=>{const D=new Map(C);return D.set(d.id,j),D})}}catch(j){if(console.error("Error al actualizar la oferta guardada:",j),m?.uid){const C=await _.getSavedJobs(m.uid);p(new Map(C.map(D=>[D.jobId,D.id])))}alert("OcurriÃ³ un error. Por favor, intÃ©ntalo de nuevo.")}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"ðŸ” Encuentra tu PrÃ³ximo Empleo"}),e.jsx("p",{className:"text-gray-600",children:"Busca en cientos de ofertas de empleo reales adaptadas a ti"})]}),e.jsx("form",{onSubmit:b,className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Puesto/Habilidad"}),e.jsx(J,{type:"text",placeholder:"ej: Frontend Developer, Data Science",value:a,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"UbicaciÃ³n"}),e.jsx(J,{type:"text",placeholder:"ej: remote, New York, Barcelona",value:r,onChange:d=>t(d.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(T,{type:"submit",isLoading:u,className:"w-full",fullWidth:!0,children:[e.jsx(ge,{size:18,className:"mr-2"}),"Buscar"]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(d=>e.jsx(Te,{job:d,isSaved:n.has(d.id),onSaveToggle:()=>E(d),showSelection:!1},d.id))}),!u&&o.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(W,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No se encontraron ofertas. Intenta con otros criterios de bÃºsqueda."})]}),u&&e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Buscando ofertas..."})]})})]})})},xe={keywords:[],locations:[],minSalary:0,experience:"Sin experiencia"},Pe={inApp:!0,email:!0,frequency:"daily",format:"summary",maxJobs:5},Bs=()=>{const{currentUserSession:a}=ce(),[s,r]=l.useState(xe),[t,o]=l.useState(Pe),[i,u]=l.useState(!1),[x,n]=l.useState(!0),[p,m]=l.useState("");l.useEffect(()=>{(async()=>{if(a?.uid){n(!0);const h=await U.getUserProfile(a.uid);h&&(r(h.jobPreferences||xe),o(h.notificationPreferences||Pe)),n(!1)}})()},[a]);const b=async()=>{if(!a?.uid)return;u(!0),m("Guardando...");const d={keywords:s.keywords??[],locations:s.locations??[],minSalary:s.minSalary??0,experience:s.experience??"Sin experiencia"},h={inApp:t.inApp??!0,email:t.email??!0,frequency:t.frequency??"daily",format:t.format??"summary",maxJobs:t.maxJobs??5};try{await U.saveUserProfile(a.uid,{jobPreferences:d,notificationPreferences:h}),m("Preferencias guardadas con Ã©xito!")}catch(j){console.error("Error guardando preferencias:",j),m("Error al guardar las preferencias.")}finally{u(!1),setTimeout(()=>m(""),3e3)}},E=()=>{r(xe)};return x?e.jsx(de,{}):e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Preferencias"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Gestiona tus preferencias de empleo y notificaciones para personalizar tu experiencia."}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm max-w-2xl space-y-8",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Preferencias de Empleo"}),e.jsx(T,{onClick:E,variant:"ghost",size:"sm",children:"Limpiar"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Configura tus preferencias de empleo para recibir mejores recomendaciones."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keywords",className:"block text-sm font-medium text-gray-700 mb-1",children:"Palabras clave (separadas por coma)"}),e.jsx(J,{type:"text",id:"keywords",placeholder:"Ej: react, node, ux",value:(s.keywords||[]).join(", "),onChange:d=>r({...s,keywords:d.target.value.split(",").map(h=>h.trim())})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"locations",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicaciones (separadas por coma)"}),e.jsx(J,{type:"text",id:"locations",placeholder:"Remoto, Santiago",value:(s.locations||[]).join(", "),onChange:d=>r({...s,locations:d.target.value.split(",").map(h=>h.trim())})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"minSalary",className:"block text-sm font-medium text-gray-700 mb-1",children:"Salario mÃ­nimo (USD)"}),e.jsx(J,{type:"number",id:"minSalary",value:s.minSalary||0,onChange:d=>r({...s,minSalary:Number(d.target.value)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"experience",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nivel de Experiencia"}),e.jsxs("select",{id:"experience",value:s.experience||"Sin experiencia",onChange:d=>r({...s,experience:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Sin experiencia"}),e.jsx("option",{children:"Junior"}),e.jsx("option",{children:"Senior"}),e.jsx("option",{children:"Lead"})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Preferencias de NotificaciÃ³n"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"email-notif",className:"font-medium text-gray-700",children:"Recibir informes por correo electrÃ³nico"}),e.jsx("input",{type:"checkbox",id:"email-notif",className:"h-6 w-6 rounded text-blue-600 focus:ring-blue-500",checked:t.email,onChange:d=>o({...t,email:d.target.checked})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"inapp-notif",className:"font-medium text-gray-700",children:"Recibir notificaciones en la app"}),e.jsx("input",{type:"checkbox",id:"inapp-notif",className:"h-6 w-6 rounded text-blue-600 focus:ring-blue-500",checked:t.inApp,onChange:d=>o({...t,inApp:d.target.checked})})]}),t.email&&e.jsxs("div",{className:"pt-4",children:[e.jsx("label",{htmlFor:"frequency",className:"block text-sm font-medium text-gray-700 mb-1",children:"Frecuencia de correos:"}),e.jsxs("select",{id:"frequency",value:t.frequency,onChange:d=>o({...t,frequency:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Diario"}),e.jsx("option",{value:"weekly",children:"Semanal"}),e.jsx("option",{value:"none",children:"Nunca"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(T,{onClick:b,isLoading:i,children:"Guardar Cambios"})}),p&&e.jsx("p",{className:"mt-4 text-sm text-center",children:p})]})]})},ze=l.createContext({user:null,loading:!0}),Ls=({children:a})=>{const[s,r]=l.useState(null),[t,o]=l.useState(!0);l.useEffect(()=>{const u=je(Y),x=Fe(u,n=>{r(n),o(!1)});return()=>x()},[]);const i={user:s,loading:t};return e.jsx(ze.Provider,{value:i,children:!t&&a})},_e=()=>l.useContext(ze),ke={keywords:[],locations:[],minSalary:0},De={inApp:!0,email:!0,frequency:"daily",format:"summary",maxJobs:5},Fs=({onLogout:a,onboardingMode:s=!1,onProfileComplete:r})=>{const{user:t}=_e(),[o,i]=l.useState(s),[u,x]=l.useState("personal"),[n,p]=l.useState({}),[m,b]=l.useState([]),[E,d]=l.useState(!1),[h,j]=l.useState(null);l.useEffect(()=>{(async()=>{if(t?.uid){const $=await U.getUserProfile(t.uid);if($){p({...$,jobPreferences:$.jobPreferences||ke,notificationPreferences:$.notificationPreferences||De});const se=($.skills||[]).map((G,me)=>({id:me,name:G,level:"Intermedio"}));b(se)}else t?.email&&p({email:t.email,jobPreferences:ke,notificationPreferences:De})}})()},[t]);const[C,D]=l.useState(""),[k,F]=l.useState("Intermedio"),I=()=>{C.trim()&&(b([...m,{id:Date.now(),name:C,level:k}]),D(""),F("Intermedio"))},Z=y=>{b(m.filter($=>$.id!==y))},ue=async()=>{if(!t?.uid||!n){j("Error: No se ha podido identificar al usuario."),d(!1);return}if(d(!0),j(null),s&&(!n.firstName||!n.phone||!n.location||!n.age)){j("Por favor, completa todos los campos obligatorios para continuar."),d(!1);return}try{const y={name:`${n.firstName||""} ${n.lastName||""}`.trim(),firstName:n.firstName,lastName:n.lastName,phone:n.phone,location:n.location,age:Number(n.age)||void 0,headline:n.headline,skills:m.map($=>$.name)};await U.saveUserProfile(t.uid,y),j("Perfil guardado correctamente"),s&&r?r():i(!1),setTimeout(()=>j(null),2500)}catch(y){console.error("Error saving profile",y),j("Error guardando el perfil")}finally{d(!1)}},ee=()=>e.jsxs("form",{className:"space-y-4",onSubmit:y=>y.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),e.jsx(J,{type:"text",value:n.firstName||"",onChange:y=>p({...n,firstName:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),e.jsx(J,{type:"text",value:n.lastName||"",onChange:y=>p({...n,lastName:y.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (no se puede cambiar)"}),e.jsx(J,{type:"email",value:n.email||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TelÃ©fono"}),e.jsx(J,{type:"tel",value:n.phone||"",onChange:y=>p({...n,phone:y.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PaÃ­s de Residencia"}),e.jsx(J,{type:"text",value:n.location||"",onChange:y=>p({...n,location:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Edad"}),e.jsx(J,{type:"number",value:n.age||"",onChange:y=>p({...n,age:String(y.target.value)}),required:!0})]})]}),!s&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DescripciÃ³n Personal"}),e.jsx("textarea",{value:n.headline||"",onChange:y=>p({...n,headline:y.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),h&&e.jsx("div",{className:`p-3 rounded-lg text-sm ${h.includes("Error")||h.includes("completa")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs(T,{onClick:ue,isLoading:E,fullWidth:!0,children:[e.jsx(ns,{size:18}),s?"Guardar y Continuar":"Guardar Cambios"]}),!s&&e.jsx(T,{onClick:()=>i(!1),variant:"secondary",children:"Cancelar"})]})]});return s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-xl",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Completa tu Perfil"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Necesitamos algunos datos mÃ¡s para personalizar tu experiencia."})]}),ee()]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.firstName||"user"}`,alt:"Foto de perfil",className:"w-16 h-16 rounded-full border-4 border-white shadow-lg"}),o&&e.jsx("button",{className:"absolute bottom-0 right-0 bg-white text-blue-600 p-2 rounded-full shadow-lg hover:bg-gray-100",children:e.jsx(ss,{size:16})})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:`${n.firstName||""} ${n.lastName||""}`.trim()||"Usuario"}),e.jsx("p",{className:"opacity-90",children:n.headline})]})]}),e.jsxs("button",{onClick:a,className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-colors flex items-center gap-2",children:[e.jsx(Re,{size:18}),"Cerrar SesiÃ³n"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(fe,{icon:e.jsx(as,{size:20}),label:"Email",value:n.email||"-"}),e.jsx(fe,{icon:e.jsx(ts,{size:20}),label:"TelÃ©fono",value:n.phone||"-"}),e.jsx(fe,{icon:e.jsx(ye,{size:20}),label:"UbicaciÃ³n",value:n.location||"-"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("div",{className:"flex gap-4",children:[{id:"personal",label:"ðŸ‘¤ InformaciÃ³n Personal"},{id:"skills",label:"ðŸ’¡ Habilidades"}].map(y=>e.jsx("button",{onClick:()=>x(y.id),className:`px-4 py-2 font-medium transition-colors ${u===y.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:y.label},y.id))})}),u==="personal"&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"InformaciÃ³n Personal"}),!o&&e.jsx("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Editar"})]}),o?ee():e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nombre Completo"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:`${n.firstName||""} ${n.lastName||""}`.trim()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:n.email||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"TelÃ©fono"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:n.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"PaÃ­s de Residencia"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:n.location||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Edad"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:n.age||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"DescripciÃ³n"}),e.jsx("p",{className:"text-gray-900",children:n.headline||"-"})]})]})]}),u==="skills"&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Habilidades Profesionales"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-6",children:m.map(y=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:y.name}),e.jsx("p",{className:"text-sm text-gray-600",children:y.level})]}),e.jsx("button",{onClick:()=>Z(y.id),className:"text-red-600 hover:text-red-700",children:e.jsx(rs,{size:20})})]},y.id))}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"AÃ±adir Nueva Habilidad"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Nombre de la habilidad (ej: Python, AWS)",value:C,onChange:y=>D(y.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("select",{value:k,onChange:y=>F(y.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"BÃ¡sico"}),e.jsx("option",{children:"Intermedio"}),e.jsx("option",{children:"Avanzado"})]}),e.jsxs("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(os,{size:18}),"AÃ±adir"]})]})]})]})]})},fe=({icon:a,label:s,value:r})=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx("div",{className:"text-blue-600",children:a}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s}),e.jsx("p",{className:"font-semibold text-gray-900",children:r})]})]}),$s=()=>{const{user:a}=_e(),[s,r]=l.useState([]),[t,o]=l.useState(!0),i=async()=>{if(!a?.uid){o(!1);return}o(!0);try{const x=await _.getSavedJobs(a.uid);r(x)}catch(x){console.error("Error al cargar los trabajos guardados:",x),r([])}finally{o(!1)}};l.useEffect(()=>{i()},[a?.uid]);const u=async x=>{if(a?.uid)try{r(n=>n.filter(p=>p.id!==x)),await _.removeSavedJob(x,a.uid)}catch(n){console.error("Error al quitar trabajo guardado:",n),i(),alert("Error al quitar el trabajo guardado.")}};return t?e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Cargando trabajos guardados..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mis Trabajos Guardados"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," guardados"]})]}),s.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-500",children:[e.jsx(W,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold",children:"No tienes ofertas guardadas"}),e.jsx("p",{className:"mt-1",children:"Usa el Ã­cono de marcador para guardar las que te interesen."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(({id:x,job:n})=>e.jsx(Te,{job:n,isSaved:!0,onSaveToggle:()=>u(x),showSelection:!1},x))})]})},Ts=()=>{const{currentUserSession:a}=ce(),[s,r]=l.useState({}),[t,o]=l.useState({}),[i,u]=l.useState(!0),[x,n]=l.useState(!1);l.useEffect(()=>{(async()=>{if(!a?.uid)return;u(!0);const d=await U.getUserProfile(a.uid),h={inApp:!0,email:!0,frequency:"daily",format:"summary",maxJobs:5},j={keywords:[],locations:[],minSalary:0};r(d?.notificationPreferences||h),o(d?.jobPreferences||j),u(!1)})()},[a]);const p=async()=>{if(!a?.uid)return;n(!0);const E={inApp:s.inApp??!0,email:s.email??!0,frequency:s.frequency??"daily",format:s.format??"summary",maxJobs:s.maxJobs??5},d={keywords:t.keywords??[],locations:t.locations??[],minSalary:t.minSalary??0};await U.saveUserProfile(a.uid,{notificationPreferences:E,jobPreferences:d}),n(!1)},m=(E,d)=>{r(h=>({...h,[E]:d}))},b=(E,d)=>{o(h=>({...h,[E]:d}))};return i?e.jsx(de,{}):e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Ajustes de Notificaciones"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Gestiona cÃ³mo y cuÃ¡ndo te informamos sobre nuevas oportunidades de empleo."}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm max-w-2xl space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 border-b pb-2",children:"Preferencias de Trabajo"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"keywords",className:"block text-sm font-medium text-gray-700",children:"Tipos de trabajo o palabras clave (separadas por coma)"}),e.jsx(J,{id:"keywords",type:"text",placeholder:"Ej: react, node, ux",value:(t.keywords||[]).join(", "),onChange:E=>b("keywords",E.target.value.split(",").map(d=>d.trim())),className:"w-full mt-2 p-3 border rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Esto es necesario para que sepamos quÃ© trabajos recomendarte."})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 border-b pb-2",children:"Canales de NotificaciÃ³n"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"email-notifications",className:"font-medium text-gray-700",children:"Recibir resÃºmenes por correo"}),e.jsx("input",{id:"email-notifications",type:"checkbox",className:"h-6 w-6 rounded text-blue-600 focus:ring-blue-500",checked:s.email||!1,onChange:E=>m("email",E.target.checked)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"inapp-notifications",className:"font-medium text-gray-700",children:"Recibir notificaciones en la app"}),e.jsx("input",{id:"inapp-notifications",type:"checkbox",className:"h-6 w-6 rounded text-blue-600 focus:ring-blue-500",checked:s.inApp||!1,onChange:E=>m("inApp",E.target.checked)})]}),s.email&&e.jsx("div",{className:"space-y-4 border-t pt-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"frequency",className:"block text-sm font-medium text-gray-700",children:"Frecuencia de correos"}),e.jsxs("select",{id:"frequency",value:s.frequency,onChange:E=>m("frequency",E.target.value),className:"w-full mt-2 p-3 border rounded-lg",children:[e.jsx("option",{value:"daily",children:"Diariamente"}),e.jsx("option",{value:"weekly",children:"Semanalmente"}),e.jsx("option",{value:"none",children:"Nunca"})]})]})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(T,{onClick:p,isLoading:x,children:"Guardar Cambios"})})]})]})},zs={user_home:Rs,saved:$s,profile:Fs,preferences:Bs,notification_settings:Ts,admin_dash:Ds},_s=({currentScreen:a,...s})=>{const r=zs[a];return r?e.jsx(r,{...s}):e.jsxs("div",{children:['Pantalla "',a,'" no encontrada.']})},Us=()=>{const[a,s]=l.useState(!0),[r,t]=l.useState(""),[o,i]=l.useState(""),[u,x]=l.useState(""),[n,p]=l.useState(""),[m,b]=l.useState(null),[E,d]=l.useState(!1),h={"auth/invalid-credential":"El correo electrÃ³nico o la contraseÃ±a son incorrectos.","auth/wrong-password":"El correo electrÃ³nico o la contraseÃ±a son incorrectos.","auth/user-not-found":"El correo electrÃ³nico o la contraseÃ±a son incorrectos.","auth/invalid-email":"El formato del correo electrÃ³nico no es vÃ¡lido.","auth/too-many-requests":"El acceso a esta cuenta ha sido deshabilitado temporalmente debido a demasiados intentos fallidos.","auth/network-request-failed":"Error de red. Por favor, comprueba tu conexiÃ³n a internet.","auth/email-already-in-use":"Este correo electrÃ³nico ya estÃ¡ registrado. Intenta iniciar sesiÃ³n.","auth/weak-password":"La contraseÃ±a es demasiado dÃ©bil. Debe tener al menos 6 caracteres."},j=(k,F)=>{const I=F?"OcurriÃ³ un error inesperado al intentar iniciar sesiÃ³n.":"OcurriÃ³ un error inesperado al registrarse.";return h[k]||I},C=async k=>{k.preventDefault(),b(null),d(!0);const F=je();try{if(a)await ys(F,o,u);else{if(u!==n)throw new Error("Las contraseÃ±as no coinciden.");if(!r.trim())throw new Error("El nombre es obligatorio.");const I=await js(F,o,u);I.user&&await U.createUser(I.user.uid,o,{name:r,role:"user"})}}catch(I){I&&typeof I=="object"&&"code"in I?b(j(I.code,a)):I instanceof Error?b(I.message):b(a?"Error al iniciar sesiÃ³n. Revisa tus credenciales.":"Error al registrarse. IntÃ©ntalo de nuevo.")}finally{d(!1)}},D=()=>{s(!a),b(null)};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center text-gray-800",children:a?"Iniciar SesiÃ³n":"Crear Cuenta"}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[!a&&e.jsx(J,{type:"text",value:r,onChange:k=>t(k.target.value),placeholder:"Nombre Completo",required:!0}),e.jsx(J,{type:"email",value:o,onChange:k=>i(k.target.value),placeholder:"Correo electrÃ³nico",required:!0}),e.jsx(J,{type:"password",value:u,onChange:k=>x(k.target.value),placeholder:"ContraseÃ±a",required:!0}),!a&&e.jsx(J,{type:"password",value:n,onChange:k=>p(k.target.value),placeholder:"Confirmar contraseÃ±a",required:!0}),m&&e.jsx("p",{className:"text-sm text-center text-red-500",children:m}),e.jsx(T,{type:"submit",isLoading:E,fullWidth:!0,children:a?"Entrar":"Registrarse"})]}),e.jsxs("p",{className:"text-sm text-center text-gray-600",children:[a?"Â¿No tienes una cuenta?":"Â¿Ya tienes una cuenta?",e.jsx("button",{onClick:D,className:"ml-1 font-semibold text-blue-600 hover:underline",children:a?"RegÃ­strate":"Inicia sesiÃ³n"})]})]})})},Ms=()=>{const{currentUserSession:a,authLoading:s,userLogout:r}=ce(),t=a?.role||null,[o,i]=l.useState("user_home"),[u,x]=l.useState(!1);l.useEffect(()=>{if(!s&&a){const m=a.role;i(m==="admin"?"admin_dash":"user_home")}},[a,s]);const n=()=>r(),p=()=>{x(!u)};return s?e.jsx(de,{}):a?e.jsx(Ss,{children:e.jsxs("div",{className:"flex h-screen w-screen bg-gray-100 font-sans relative",children:[" ",e.jsx(Ce,{userRole:t,currentScreen:o,setCurrentScreen:i,handleLogout:n}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>x(!1)}),e.jsx("aside",{className:`fixed inset-y-0 left-0 w-64 bg-white z-50 transform ${u?"translate-x-0":"-translate-x-full"} transition-transform duration-300 ease-in-out md:hidden`,children:e.jsx(Ce,{userRole:t,currentScreen:o,setCurrentScreen:i,handleLogout:n,onItemClick:()=>x(!1)})}),e.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(As,{onMenuToggle:p}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:e.jsx(_s,{currentScreen:o,currentUserSession:a,handleLogout:n})})]}),e.jsx(Es,{userRole:t,currentScreen:o,setCurrentScreen:i})]})}):e.jsx(Us,{})},qs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://api-3qc6rr746q-uc.a.run.app",VITE_FIREBASE_API_KEY:"AIzaSyBTFeZb2YghE21teJcC475Tm9a0ybfF2Xg",VITE_FIREBASE_APP_ID:"1:640735978088:web:ae416ed336a03e41a5d1dd",VITE_FIREBASE_AUTH_DOMAIN:"chapatuchamba-cdd3a.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"640735978088",VITE_FIREBASE_PROJECT_ID:"chapatuchamba-cdd3a",VITE_FIREBASE_STORAGE_BUCKET:"chapatuchamba-cdd3a.appspot.com"};console.log("[DEBUG] Variables de entorno cargadas por Vite:",qs);const Ie=document.getElementById("root");Ie?is.createRoot(Ie).render(e.jsx(ls.StrictMode,{children:e.jsx(Ls,{children:e.jsx(Ms,{})})})):console.error("CRÃTICO: No se encontrÃ³ el elemento con id 'root' en el HTML.");
